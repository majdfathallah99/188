<odoo>
    <record id="view_predictive_wizard_form" model="ir.ui.view">
        <field name="name">predictive.dashboard.wizard.form.v110</field>
        <field name="model">predictive.dashboard.wizard</field>
        <field name="arch" type="xml">
            <form string="Predictive Dashboard">
                <header>
                    <button name="action_compute" type="object" string="Compute" class="btn-primary"/>
                    <button name="action_export_xlsx" type="object" string="Export XLSX" invisible="state != 'ready'"/>
                    <button name="action_print_report" type="object" string="Print PDF" invisible="state != 'ready'"/>
                </header>

                <sheet>
                    <!-- KPIs -->
                    <group string="KPIs" col="8">
                        <group col="4">
                            <field name="kpi_total_items" readonly="1"/>
                            <field name="kpi_total_forecast" readonly="1"/>
                        </group>
                        <group col="4">
                            <field name="kpi_total_onhand" readonly="1"/>
                            <field name="kpi_at_risk_count" readonly="1"/>
                        </group>
                    </group>

                    <group col="8">
                        <group string="Scope">
                            <field name="company_id"/>
                            <field name="warehouse_id"/>
                            <field name="location_ids" widget="many2many_tags" domain="[('usage','=','internal')]"/>
                            <field name="product_category_id"/>
                        </group>

                        <group string="Window &amp; Method">
                            <field name="date_from"/>
                            <field name="date_to"/>
                            <field name="group_by"/>
                            <field name="method"/>
                            <field name="wma_window" invisible="method != 'wma'"/>
                            <field name="ets_alpha" invisible="method != 'ets'"/>
                            <field name="horizon_days"/>
                            <field name="top_n"/>
                        </group>

                        <group string="Demand Source">
                            <field name="use_stock_based"/>
                            <field name="include_returns" readonly="not use_stock_based"/>
                        </group>

                        <group string="Alerts">
                            <field name="warn_threshold_days"/>
                            <field name="create_activities"/>
                            <field name="send_email_notifications"/>
                        </group>
                    </group>

                    <notebook>
                        <page string="Forecast Lines">
                            <field name="line_ids" nolabel="1"/>
                        </page>
                    </notebook>
                </sheet>
            </form>
        </field>
    </record>

    <!-- الإجراء والقائمة لفتح الـ Wizard (موجودين عندك غالبًا) -->
    <record id="action_predictive_dashboard" model="ir.actions.act_window">
        <field name="name">Predictive Dashboard</field>
        <field name="res_model">predictive.dashboard.wizard</field>
        <field name="view_mode">form</field>
        <field name="target">current</field>
    </record>

    <menuitem id="menu_predictive_root" name="Predictive" sequence="10"/>
    <menuitem id="menu_predictive_dashboard" name="Dashboard" parent="menu_predictive_root"
              action="action_predictive_dashboard" sequence="10"/>

    <!-- عرض كل عمليات الـ Wizard (List + Form) -->
    <record id="view_predictive_wizard_list" model="ir.ui.view">
        <field name="name">predictive.dashboard.wizard.list</field>
        <field name="model">predictive.dashboard.wizard</field>
        <field name="arch" type="xml">
            <list string="Predictive Runs" create="true" edit="false" delete="true">
                <field name="name"/>
                <field name="company_id"/>
                <field name="date_from"/>
                <field name="date_to"/>
                <field name="group_by"/>
                <field name="method"/>
                <field name="top_n"/>
                <field name="state"/>
                <field name="line_count"/>
                <field name="kpi_total_items"/>
                <field name="kpi_total_forecast"/>
                <field name="kpi_total_onhand"/>
                <field name="kpi_at_risk_count"/>
                <field name="create_date"/>
            </list>
        </field>
    </record>

    <record id="action_predictive_all_operations" model="ir.actions.act_window">
        <field name="name">All Operations</field>
        <field name="res_model">predictive.dashboard.wizard</field>
        <field name="view_mode">list,form</field>
    </record>

    <menuitem id="menu_predictive_all_operations" name="All Operations"
              parent="menu_predictive_root" action="action_predictive_all_operations" sequence="20"/>
</odoo>
