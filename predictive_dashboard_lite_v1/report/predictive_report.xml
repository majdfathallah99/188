<odoo>
    <!-- QWeb template for the PDF -->
    <template id="predictive_report_tmpl">
        <t t-call="web.external_layout">
            <div class="page">
                <h2>Predictive Forecast</h2>
                <p>
                    <strong>Company:</strong>
                    <span t-esc="doc.company_id.display_name"/><br/>
                    <strong>Period:</strong>
                    <span t-esc="doc.date_from"/> â†’ <span t-esc="doc.date_to"/><br/>
                    <strong>Method:</strong>
                    <span t-esc="dict(doc.fields_get(['method'])['method']['selection'])[doc.method]"/><br/>
                    <strong>Group by:</strong>
                    <span t-esc="dict(doc.fields_get(['group_by'])['group_by']['selection'])[doc.group_by]"/>
                </p>

                <t t-if="doc.line_ids">
                    <table class="table table-sm o_main_table">
                        <thead>
                            <tr>
                                <th>Key</th>
                                <th>UoM</th>
                                <th class="text-end">Qty in Window</th>
                                <th class="text-end">Daily Rate</th>
                                <th class="text-end">Forecast</th>
                                <th class="text-end">On Hand</th>
                                <th class="text-end">Days till Shortage</th>
                                <th class="text-end">Shortage Date</th>
                            </tr>
                        </thead>
                        <tbody>
                            <t t-foreach="doc.line_ids" t-as="l">
                                <tr>
                                    <td><span t-esc="l.display_key"/></td>
                                    <td><span t-esc="l.uom_id.display_name or ''"/></td>
                                    <td class="text-end"><span t-esc="l.qty_window"/></td>
                                    <td class="text-end"><span t-esc="('%.4f' % (l.daily_rate or 0.0))"/></td>
                                    <td class="text-end"><span t-esc="l.forecast_qty"/></td>
                                    <td class="text-end"><span t-esc="l.stock_onhand"/></td>
                                    <td class="text-end"><span t-esc="('%.2f' % (l.days_until_shortage or 0.0))"/></td>
                                    <td class="text-end"><span t-esc="l.shortage_date or ''"/></td>
                                </tr>
                            </t>
                        </tbody>
                    </table>
                </t>
                <p t-else><em>No lines to print. Use Compute first.</em></p>
            </div>
        </t>
    </template>
</odoo>
